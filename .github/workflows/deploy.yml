name: SPFx CICD with O365 CLI
on: [push]
jobs:
  ubuntu:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [10.x]
    
    steps:
      - name: Checkout code 4
        uses: actions/checkout@v1
      - name: Office 365 CLI Login
        uses: VelinGeorgiev/action-cli-login@master
        with:
          ADMIN_USERNAME:  ${{ secrets.adminUsername }}
          ADMIN_PASSWORD:  ${{ secrets.adminPassword }}
      - name: Office 365 CLI script SH
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT: o365 spo tenant appcatalogurl get
          IS_POWERSHELL: false
      - name: Office 365 CLI script PS
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT: o365 spo tenant appcatalogurl get
          IS_POWERSHELL: true
      - name: ls
        run: ls
        shell: bash
      - name: Office 365 CLI script PS FILE
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT_PATH: ./testps.ps1
          IS_POWERSHELL: true
      - name: Office 365 CLI script SH FILE
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT_PATH: ./testsh.sh
          IS_POWERSHELL: false
      - name: Office 365 CLI script SH FILE (AUTO DISCOVER)
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT_PATH: ./testsh.sh
          IS_POWERSHELL: true
      - name: Office 365 CLI script PS FILE (AUTO DISCOVER)
        uses: VelinGeorgiev/action-cli-runscript@master
        with:
          O365_CLI_SCRIPT_PATH: ./testps.ps1
          IS_POWERSHELL: false
      - name: bundle solution
        run: npm run bundle --ship && npm run package-solution --ship
        shell: bash